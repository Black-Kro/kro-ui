<template>
    <component 
        :is="tag || 'div'"
        v-show="!isHidden"
        :class="{
            'kro-alert': true, 
            'kro-alert--error': type === 'error',
            'kro-alert--info': type === 'info',
            'kro-alert--warning': type === 'warning',
            'kro-alert--success': type === 'success',
            'kro-alert--outline': outline,
            'kro-alert--has-icon': iconName,
            'kro-alert--is-dismissible': dismissible,
        }">
        
        
        <div class="kro-alert__icon">
            <kro-icon v-if="icon || type" :icon="icon || type"></kro-icon>
        </div>
        <div>
            <slot></slot>
        </div>
        <div v-if="dismissible">
            <kro-button @click="hide" icon="close" />
        </div>
    </component>
</template>

<script lang="ts" setup="props, { emit }">
    import { ref, computed } from 'vue';
    import { KroIcon } from '../Icon';
    import { KroButton } from '../Button';

    export default {
        name: 'KroAlert',
        components: { KroIcon, KroButton },
        emits: ['dismissed', 'show'],
    }

    declare const props: {
        tag: string;
        type: string;
        icon: string;
        outline: boolean;
    }
</script>

<style lang="scss">

    .kro-alert {
        --kro-button-background: rgba(0, 0, 0, .12);
        --kro-button-foreground: var(--kro-alert-foreground);

        border-radius: 0.25rem;
        padding: 0 1rem;
        height: 4rem;

        display: grid;
        grid-auto-flow: column;
        grid-gap: 1rem;
        align-items: center;
        align-content: center;

        background: var(--kro-alert-background, var(--kro-background-secondary));
        color: var(--kro-alert-foreground, var(--kro-foreground));
    }

        .kro-alert--has-icon { grid-template-columns: min-content auto; }
        .kro-alert--is-dismissible { grid-template-columns: auto min-content; }

        .kro-alert--has-icon,
        .kro-alert--is-dismissible {
            grid-template-columns: min-content auto min-content;
        }

        .kro-alert--error {
            --kro-alert-background: var(--kro-error);
            --kro-alert-foreground: var(--kro-error-foreground);
        }

        .kro-alert--warning {
            --kro-alert-background: var(--kro-warning);
            --kro-alert-foreground: var(--kro-warning-foreground);
        }

        .kro-alert--success {
            --kro-alert-background: var(--kro-success);
            --kro-alert-foreground: var(--kro-success-foreground);
        }
        
        .kro-alert--info {
            --kro-alert-background: var(--kro-info);
            --kro-alert-foreground: var(--kro-info-foreground);
        }

        .kro-alert--outline {
            background: transparent;
            --kro-alert-foreground: var(--kro-alert-background);
            border: 1px solid var(--kro-alert-background);
        }

    .kro-alert__icon {
        display: grid;
        place-items: center;
        border-radius: 50%;
        background: rgba(0, 0, 0, .12);
        width: 2.75rem;
        height: 2.75rem;
    }

</style>